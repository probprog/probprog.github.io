<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="shortcut icon" href="/anglican/assets/ico/anglican_logo.ico">

    <title>The Anglican Probabilistic Programming System</title>

    <!-- Bootstrap core CSS -->
    <link href="/anglican/assets/css/bootstrap.css" rel="stylesheet">
    <link href="/anglican/assets/css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="/anglican/assets/css/jwvdm.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery.js"></script>
    <script src="/anglican/assets/js/bootstrap.min.js"></script>
    <link href="/anglican/assets/css/syntax.css" rel="stylesheet">
    <link href="/anglican/assets/css/ribbon.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="/anglican/assets/js/html5shiv.js"></script>
      <script src="/anglican/assets/js/respond.min.js"></script>
    <![endif]-->
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-61399035-3', 'auto');
  ga('send', 'pageview');

</script>
</head>

  <body>
    <div class="container">
      <div class="header row">
        <div class="row">
	<a href="/anglican"> 
		<img class="logo" src="/anglican/assets/images/anglican_logo.png" height="30px" align="bottom"> 
		<span class="title">
			Anglican
		</span>
		</a>
    <ul class="nav nav-pills pull-right">
      
      <li >
        <a href="/anglican/index.html" title="">Home</a>
      </li>
      <!-- class="active"><a href="/">About</a></li> -->
      <!-- <li><a href="/projects">Projects</a></li> -->
      <!-- <li><a href="/publications">Publications</a></li> -->
      
      <li >
        <a href="/anglican/examples/index.html" title="">Examples</a>
      </li>
      <!-- class="active"><a href="/">About</a></li> -->
      <!-- <li><a href="/projects">Projects</a></li> -->
      <!-- <li><a href="/publications">Publications</a></li> -->
      
      <li >
        <a href="/anglican/language/index.html" title="">Language</a>
      </li>
      <!-- class="active"><a href="/">About</a></li> -->
      <!-- <li><a href="/projects">Projects</a></li> -->
      <!-- <li><a href="/publications">Publications</a></li> -->
      
      <li >
        <a href="/anglican/inference/index.html" title="">Inference</a>
      </li>
      <!-- class="active"><a href="/">About</a></li> -->
      <!-- <li><a href="/projects">Projects</a></li> -->
      <!-- <li><a href="/publications">Publications</a></li> -->
      
      <li >
        <a href="/anglican/literature/index.html" title="">Literature</a>
      </li>
      <!-- class="active"><a href="/">About</a></li> -->
      <!-- <li><a href="/projects">Projects</a></li> -->
      <!-- <li><a href="/publications">Publications</a></li> -->
      
    </ul>
</div>

<script>
  $()
</script>
       
      </div>
      <div class="content row">
        <h2 id="anglican---a-probabilistic-programming-system">Anglican - A Probabilistic Programming System</h2>

<p><a href="https://bitbucket.org/probprog/anglican">Anglican</a> is a probabilistic
programming language integrated with <a href="http://clojure.org/">Clojure</a> and
<a href="http://clojurescript.org/">ClojureScript</a>.</p>

<p>While Anglican incorporates a sophisticated theoretical background that you are
invited to explore, its value proposition is to allow intuitive modeling in a
stochastic environment. It is not an academic exercise, but a practical everyday
machine learning tool that makes probabilistic reasoning effective for you.</p>

<p>Do you interact with users or remote systems? Then you often make the
unfortunate experience that they act unpredictably. Mathematically speaking you
observe undeterministic or stochastic behaviour. Anglican allows you to express
random variables capturing all this stochasticity for you and helps you to learn
from data to execute informed decisions in your Clojure programs.</p>

<h3 id="contact">Contact</h3>

<p><a href="https://clojurians.slack.com/messages/anglican/">Join us on slack</a> if you have
any questions or suggestions. We are happy to learn about your experience!</p>

<h2 id="getting-started">Getting started</h2>

<p>Add the following dependency to your project (e.g. with
<a href="https://leiningen.org/">Leiningen</a>):</p>

<p><a href="https://clojars.org/anglican"><img src="https://img.shields.io/clojars/v/anglican.svg" alt="Clojars Project" /></a></p>

<p>You can also clone the <a href="https://bitbucket.org/probprog/anglican-examples/">examples
repository</a> and run <code class="highlighter-rouge">lein
gorilla</code> to get a quick setup.</p>

<p>A typical hello world example in statistics is a <a href="https://en.wikipedia.org/wiki/Coin_flipping">coin flip
model</a>. Our coin has two sides,
head and tail. Intuitively given a set of observed values of a coin you would
now like to know how fair it is. Mathematically speaking we want to know the
probability of head turning up. Let’s encode a model for this:</p>

<div class="language-clojure highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="nf">ns</span><span class="w"> </span><span class="n">anglican.coin-flips</span><span class="w">
  </span><span class="p">(</span><span class="no">:use</span><span class="w"> </span><span class="p">[</span><span class="n">anglican</span><span class="w"> </span><span class="n">core</span><span class="w"> </span><span class="n">emit</span><span class="w"> </span><span class="n">runtime</span><span class="p">]))</span><span class="w">
  

</span><span class="p">(</span><span class="nf">defquery</span><span class="w"> </span><span class="n">coin-model</span><span class="w"> </span><span class="p">[</span><span class="n">coin-series</span><span class="p">]</span><span class="w">
  </span><span class="p">(</span><span class="k">let</span><span class="w"> </span><span class="p">[</span><span class="n">prob</span><span class="w"> </span><span class="p">(</span><span class="nf">sample</span><span class="w"> </span><span class="p">(</span><span class="nf">beta</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">1</span><span class="p">))]</span><span class="w"> </span><span class="c1">;; 1. prior</span><span class="w">
    </span><span class="p">(</span><span class="nb">loop</span><span class="w"> </span><span class="p">[[</span><span class="n">f</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">r</span><span class="p">]</span><span class="w"> </span><span class="n">coin-series</span><span class="p">]</span><span class="w">
      </span><span class="p">(</span><span class="nb">when</span><span class="w"> </span><span class="n">f</span><span class="w">
        </span><span class="p">(</span><span class="nf">observe</span><span class="w"> </span><span class="p">(</span><span class="nf">flip</span><span class="w"> </span><span class="n">prob</span><span class="p">)</span><span class="w"> </span><span class="n">f</span><span class="p">)</span><span class="w"> </span><span class="c1">;; 2. incorporate data</span><span class="w">
        </span><span class="p">(</span><span class="nf">recur</span><span class="w"> </span><span class="n">r</span><span class="p">)))</span><span class="w">
    </span><span class="n">prob</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<p>Anglican provides us primitives to build a model for our coin. If you are
familiar with Clojure, you will spot them: <code class="highlighter-rouge">defquery</code>, <code class="highlighter-rouge">sample</code> and <code class="highlighter-rouge">observe</code>.
<code class="highlighter-rouge">defquery</code> just sets up the scope of our model and allows us to give it the name
<code class="highlighter-rouge">coin-model</code> and define an input slot for our data as <code class="highlighter-rouge">coin-series</code>. In 1. we
define our prior belief without seeing any data. Let’s just pick the <a href="https://en.wikipedia.org/wiki/Beta_distribution">beta
distribution</a>, because it
defines a probability between 0 and 1 and we assume that the coin is rather
fair. You can incorporate any other prior belief by tweaking the two parameters
of the Beta distribution though.</p>

<div class="language-clojure highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="nf">sample*</span><span class="w"> </span><span class="p">(</span><span class="nf">beta</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="c1">;; =&gt; 0.7185479773538508</span><span class="w">
</span></code></pre></div></div>
<p>(Note: <code class="highlighter-rouge">sample*</code> has to be used if you run it outside a query.)</p>

<p>In our model we then <code class="highlighter-rouge">sample</code> this value in the query and will plug it into the
<code class="highlighter-rouge">flip</code> distribution to <code class="highlighter-rouge">observe</code> each data point in 2.. If we have no data then
the loop will not run and we will get just our prior belief samples. This is not
really that helpful though. Anglican does its magic when you start to provide
observed values from the coin. For this we use <code class="highlighter-rouge">doquery</code>.</p>

<div class="language-clojure highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="nf">-&gt;&gt;</span><span class="w"> </span><span class="p">(</span><span class="nf">doquery</span><span class="w"> </span><span class="no">:smc</span><span class="w"> </span><span class="n">coin-model</span><span class="w"> </span><span class="p">[[</span><span class="n">true</span><span class="p">]]</span><span class="w"> </span><span class="no">:number-of-particles</span><span class="w"> </span><span class="mi">10000</span><span class="p">)</span><span class="w">
   </span><span class="p">(</span><span class="nb">take</span><span class="w"> </span><span class="mi">10</span><span class="p">)</span><span class="w">
   </span><span class="p">(</span><span class="nb">map</span><span class="w"> </span><span class="no">:result</span><span class="p">))</span><span class="w">

</span><span class="c1">;; =&gt; (0.98529804829141 0.5948306954057996 0.5948306954057996 0.3579256597687244 0.9818148690925241 0.9818148690925241 0.4539746712124162 0.8944478678159888 0.8944478678159888 0.3433014675748332)</span><span class="w">
</span></code></pre></div></div>

<p>(Note: <code class="highlighter-rouge">doquery</code> receives a few arguments for the Sequential Monte Carlo method.
You can <a href="./inference/">look up each of those for inference</a>. An attribute of the
method is that you might get the same value multiple times in a statistically
consistent manner.)</p>

<p>You might know from real-life or a statistics course that having very few
examples, only one here, will not allow you to infer the probability of head.
Anglican provides you a so called posterior distribution after seeing the
values. As you can see our distribution is already considerably tilted towards 1.</p>

<p>Let’s assume we observe 8 times heads:</p>

<div class="language-clojure highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="nf">-&gt;&gt;</span><span class="w"> </span><span class="p">(</span><span class="nf">doquery</span><span class="w"> </span><span class="no">:smc</span><span class="w"> </span><span class="n">coin-model</span><span class="w"> </span><span class="p">[[</span><span class="n">true</span><span class="w"> </span><span class="n">true</span><span class="w"> </span><span class="n">true</span><span class="w"> </span><span class="n">true</span><span class="w"> </span><span class="n">true</span><span class="w"> </span><span class="n">true</span><span class="w"> </span><span class="n">true</span><span class="w"> </span><span class="n">true</span><span class="p">]]</span><span class="w"> </span><span class="no">:number-of-particles</span><span class="w"> </span><span class="mi">10000</span><span class="p">)</span><span class="w">
   </span><span class="p">(</span><span class="nb">take</span><span class="w"> </span><span class="mi">10</span><span class="p">)</span><span class="w">
   </span><span class="p">(</span><span class="nb">map</span><span class="w"> </span><span class="no">:result</span><span class="p">))</span><span class="w">
   
</span><span class="c1">;; =&gt; (0.9068541546104443 0.9068541546104443 0.9664328786599636 0.9664328786599636 0.9664328786599636 0.9664328786599636 0.9664328786599636 0.9664328786599636 0.9664328786599636 0.9664328786599636)</span><span class="w">
</span></code></pre></div></div>

<p>Our posterior distribution confirms our intuition that this coin is very
unlikely, but still incorporates some uncertainty about the actual flipping
probability. We can be pretty sure that somebody is trying to cheat with this
coin here… Congratulations! You have just conducted your first
<a href="https://en.wikipedia.org/wiki/Bayesian_probability">Bayesian</a> inference.
Bayesian inference allows you to both intuitively incorporate expert knowledge
in the prior to work in a small data regime, while correcting wrong prior
beliefs with more data.</p>

<p>What happens if you pick a different prior, e.g. tweaking the <code class="highlighter-rouge">beta</code> parameters
to 10 and 10? Try to use a larger data set. Do you see that the effect of the
prior belief vanishes?</p>

<h2 id="theory">Theory</h2>

<iframe width="560" height="315" src="https://www.youtube.com/embed/6Lqt07enBGs" frameborder="0" allowfullscreen=""></iframe>

<p>Anglican and Clojure share a common syntax, and can be invoked from
each other. This allows Anglican programs to make use of a rich
set of libraries written in both Clojure and Java.  Conversely
Anglican allows intuitive and compact specification of models
for which inference may be performed as part of a larger Clojure
project.</p>

<h3 id="language">Language</h3>

<p>Anglican provides a language to abstract the statistical inference from the
Clojure runtime. If you are just interested in using Anglican, you can read the
details of it <a href="./language/">in the language section</a> and ignore
the details about inference. You might have to try to different inference
methods depending on the nature of your model, but you do not need to learn any
of the statistics involved.</p>

<h3 id="inference">Inference</h3>

<p>The underlying inference methods are document <a href="./inference/">in the inference
section</a>. If you have a statistics background or are interested to
learn more about the mechanics behind Anglican’s language primitives you are
invited to study the details. If you have any particular questions feel free to
join our slack channel.</p>

<h3 id="background">Background</h3>

<p>The theoretical background is documented in peer-reviewed, state-of-the-art
<a href="./literature/">academic literature</a>.</p>

<h2 id="contributors">Contributors</h2>

<p>Core contributors, in order of joining:</p>

<ul>
  <li><a href="http://www.robots.ox.ac.uk/~fwood/">Frank Wood</a> – original prototype, smc and particle gibbs</li>
  <li><a href="http://www.robots.ox.ac.uk/~jwvdm/">Jan Willem van de Meent</a> – first release, inference methods</li>
  <li><a href="http://offtopia.net/">David Tolpin</a> – second release, CPS transformation, inference methods</li>
</ul>

<p>as well as many others, in alphabetical order:</p>

<ul>
  <li><a href="http://www.tuananhle.co.uk/">Tuan Anh Le</a></li>
  <li><a href="http://www.robots.ox.ac.uk/~brooks/">Brooks Paige</a></li>
  <li><a href="http://www.yuraperov.com/">Yura Perov</a></li>
  <li><a href="http://www.robots.ox.ac.uk/~twgr/">Tom Rainforth</a></li>
  <li><a href="http://www.cs.ox.ac.uk/people/hongseok.yang/Public/Home.html">Hongseok Yang</a></li>
</ul>

<h2 id="funding">Funding</h2>

<p>This work is supported under DARPA PPAML through the U.S. AFRL
under Cooperative Agreement number FA8750-14-2-0004. The U.S.
Government is authorized to reproduce and distribute reprints
for Governmental purposes notwithstanding any copyright notation
heron. The views and conclusions contained herein are those of
the authors and should be not interpreted as necessarily
representing the official policies or endorsements, either
expressed or implied, of DARPA, the U.S. Air Force Research
Laboratory or the U.S. Government.</p>

      </div>
      <div class="footer row">
        <p>
    &copy; Frank Wood 2014-2018
    built using 
    <a href="http://jekyllrb.com">jekyll</a>, 
    <a href="https://github.com/inukshuk/jekyll-scholar">jekyll-scholar</a> and 
    <a href="http://getbootstrap.com">bootstrap</a>. 
    Website design by <a href="http://www.robots.ox.ac.uk/~jwvdm/">Jan Willem van de Meent</a>
</p> 
       
      </div>
    </div>

    <div class="ribbon">
      <a href="https://bitbucket.org/probprog/anglican/">Fork me on BitBucket</a>
    </div>
  </body>
</html>
