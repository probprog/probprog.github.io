<!DOCTYPE html>
<html><head><meta charset="UTF-8"><link href="css/default.css" rel="stylesheet" type="text/css"><script src="js/jquery.min.js" type="text/javascript"></script><script src="js/page_effects.js" type="text/javascript"></script><title>anglican.trap documentation</title></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html">Anglican 0.6.5 API documentation</a></h1></div><div class="sidebar" id="namespaces"><h3><a href="index.html"><span class="inner">Namespaces</span></a></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>anglib</span></div></div></li><li class="depth-2 branch"><a href="anglib.beaver-data.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>beaver-data</span></div></a></li><li class="depth-2 branch"><a href="anglib.crp.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>crp</span></div></a></li><li class="depth-2 branch"><a href="anglib.iris-data.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>iris-data</span></div></a></li><li class="depth-2 branch"><a href="anglib.state-space.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>state-space</span></div></a></li><li class="depth-2"><a href="anglib.xrp.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>xrp</span></div></a></li><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree" style="top: -176px;"><span class="top" style="height: 185px;"></span><span class="bottom"></span></span><span>anglican</span></div></div></li><li class="depth-2 branch"><a href="anglican.bamc.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>bamc</span></div></a></li><li class="depth-2 branch"><a href="anglican.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-2 branch"><a href="anglican.emit.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>emit</span></div></a></li><li class="depth-2 branch"><a href="anglican.importance.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>importance</span></div></a></li><li class="depth-2 branch"><a href="anglican.inference.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>inference</span></div></a></li><li class="depth-2 branch"><a href="anglican.pcascade.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>pcascade</span></div></a></li><li class="depth-2 branch"><a href="anglican.pfilter.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>pfilter</span></div></a></li><li class="depth-2 branch"><a href="anglican.pgibbs.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>pgibbs</span></div></a></li><li class="depth-2 branch"><a href="anglican.pimh.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>pimh</span></div></a></li><li class="depth-2 branch"><a href="anglican.rdb.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>rdb</span></div></a></li><li class="depth-2 branch"><a href="anglican.results.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>results</span></div></a></li><li class="depth-2 branch"><a href="anglican.runtime.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>runtime</span></div></a></li><li class="depth-2 branch"><a href="anglican.siman.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>siman</span></div></a></li><li class="depth-2 branch"><a href="anglican.smc.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>smc</span></div></a></li><li class="depth-2 branch"><a href="anglican.state.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>state</span></div></a></li><li class="depth-2 branch current"><a href="anglican.trap.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>trap</span></div></a></li><li class="depth-2"><a href="anglican.xlat.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>xlat</span></div></a></li></ul></div><div class="sidebar" id="vars"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="anglican.trap.html#var-*gensym*"><div class="inner"><span>*gensym*</span></div></a></li><li class="depth-1"><a href="anglican.trap.html#var-*primitive-procedures*"><div class="inner"><span>*primitive-procedures*</span></div></a></li><li class="depth-1"><a href="anglican.trap.html#var--.3Eobserve"><div class="inner"><span>-&gt;observe</span></div></a></li><li class="depth-1"><a href="anglican.trap.html#var--.3Eresult"><div class="inner"><span>-&gt;result</span></div></a></li><li class="depth-1"><a href="anglican.trap.html#var--.3Esample"><div class="inner"><span>-&gt;sample</span></div></a></li><li class="depth-1"><a href="anglican.trap.html#var-continue"><div class="inner"><span>continue</span></div></a></li><li class="depth-1"><a href="anglican.trap.html#var-cps-of-and"><div class="inner"><span>cps-of-and</span></div></a></li><li class="depth-1"><a href="anglican.trap.html#var-cps-of-application"><div class="inner"><span>cps-of-application</span></div></a></li><li class="depth-1"><a href="anglican.trap.html#var-cps-of-apply"><div class="inner"><span>cps-of-apply</span></div></a></li><li class="depth-1"><a href="anglican.trap.html#var-cps-of-case"><div class="inner"><span>cps-of-case</span></div></a></li><li class="depth-1"><a href="anglican.trap.html#var-cps-of-cond"><div class="inner"><span>cps-of-cond</span></div></a></li><li class="depth-1"><a href="anglican.trap.html#var-cps-of-do"><div class="inner"><span>cps-of-do</span></div></a></li><li class="depth-1"><a href="anglican.trap.html#var-cps-of-expression"><div class="inner"><span>cps-of-expression</span></div></a></li><li class="depth-1"><a href="anglican.trap.html#var-cps-of-hash-map"><div class="inner"><span>cps-of-hash-map</span></div></a></li><li class="depth-1"><a href="anglican.trap.html#var-cps-of-if"><div class="inner"><span>cps-of-if</span></div></a></li><li class="depth-1"><a href="anglican.trap.html#var-cps-of-let"><div class="inner"><span>cps-of-let</span></div></a></li><li class="depth-1"><a href="anglican.trap.html#var-cps-of-loop"><div class="inner"><span>cps-of-loop</span></div></a></li><li class="depth-1"><a href="anglican.trap.html#var-cps-of-observe"><div class="inner"><span>cps-of-observe</span></div></a></li><li class="depth-1"><a href="anglican.trap.html#var-cps-of-opaque"><div class="inner"><span>cps-of-opaque</span></div></a></li><li class="depth-1"><a href="anglican.trap.html#var-cps-of-or"><div class="inner"><span>cps-of-or</span></div></a></li><li class="depth-1"><a href="anglican.trap.html#var-cps-of-predict"><div class="inner"><span>cps-of-predict</span></div></a></li><li class="depth-1"><a href="anglican.trap.html#var-cps-of-recur"><div class="inner"><span>cps-of-recur</span></div></a></li><li class="depth-1"><a href="anglican.trap.html#var-cps-of-retrieve"><div class="inner"><span>cps-of-retrieve</span></div></a></li><li class="depth-1"><a href="anglican.trap.html#var-cps-of-sample"><div class="inner"><span>cps-of-sample</span></div></a></li><li class="depth-1"><a href="anglican.trap.html#var-cps-of-set"><div class="inner"><span>cps-of-set</span></div></a></li><li class="depth-1"><a href="anglican.trap.html#var-cps-of-store"><div class="inner"><span>cps-of-store</span></div></a></li><li class="depth-1"><a href="anglican.trap.html#var-cps-of-vector"><div class="inner"><span>cps-of-vector</span></div></a></li><li class="depth-1"><a href="anglican.trap.html#var-cps-of-when"><div class="inner"><span>cps-of-when</span></div></a></li><li class="depth-1"><a href="anglican.trap.html#var-defn-with-named-cont"><div class="inner"><span>defn-with-named-cont</span></div></a></li><li class="depth-1"><a href="anglican.trap.html#var-fn-cps"><div class="inner"><span>fn-cps</span></div></a></li><li class="depth-1"><a href="anglican.trap.html#var-fn-form.3F"><div class="inner"><span>fn-form?</span></div></a></li><li class="depth-1"><a href="anglican.trap.html#var-make-of-args"><div class="inner"><span>make-of-args</span></div></a></li><li class="depth-1"><a href="anglican.trap.html#var-map-.3Eobserve"><div class="inner"><span>map-&gt;observe</span></div></a></li><li class="depth-1"><a href="anglican.trap.html#var-map-.3Eresult"><div class="inner"><span>map-&gt;result</span></div></a></li><li class="depth-1"><a href="anglican.trap.html#var-map-.3Esample"><div class="inner"><span>map-&gt;sample</span></div></a></li><li class="depth-1"><a href="anglican.trap.html#var-mem-cps"><div class="inner"><span>mem-cps</span></div></a></li><li class="depth-1"><a href="anglican.trap.html#var-mem-form.3F"><div class="inner"><span>mem-form?</span></div></a></li><li class="depth-1"><a href="anglican.trap.html#var-opaque-cps"><div class="inner"><span>opaque-cps</span></div></a></li><li class="depth-1"><a href="anglican.trap.html#var-opaque.3F"><div class="inner"><span>opaque?</span></div></a></li><li class="depth-1"><a href="anglican.trap.html#var-primitive-operator.3F"><div class="inner"><span>primitive-operator?</span></div></a></li><li class="depth-1"><a href="anglican.trap.html#var-primitive-procedure-cps"><div class="inner"><span>primitive-procedure-cps</span></div></a></li><li class="depth-1"><a href="anglican.trap.html#var-primitive-procedure.3F"><div class="inner"><span>primitive-procedure?</span></div></a></li><li class="depth-1"><a href="anglican.trap.html#var-result-cont"><div class="inner"><span>result-cont</span></div></a></li><li class="depth-1"><a href="anglican.trap.html#var-shading-primitive-procedures"><div class="inner"><span>shading-primitive-procedures</span></div></a></li><li class="depth-1"><a href="anglican.trap.html#var-simple.3F"><div class="inner"><span>simple?</span></div></a></li><li class="depth-1"><a href="anglican.trap.html#var-state-cont"><div class="inner"><span>state-cont</span></div></a></li><li class="depth-1"><a href="anglican.trap.html#var-value-cont"><div class="inner"><span>value-cont</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h2 class="anchor" id="top">anglican.trap</h2><div class="doc"><pre class="plaintext">CPS transformation of Anglican program
</pre></div><div class="public anchor" id="var-*gensym*"><h3>*gensym*</h3><h4 class="dynamic">dynamic</h4><div class="usage"></div><div class="doc"><pre class="plaintext">customized gensym for code generation,
bound to `symbol&apos; in tests</pre></div></div><div class="public anchor" id="var-*primitive-procedures*"><h3>*primitive-procedures*</h3><h4 class="dynamic">dynamic</h4><div class="usage"></div><div class="doc"><pre class="plaintext">primitive procedures, do not exist in CPS form
</pre></div></div><div class="public anchor" id="var--.3Eobserve"><h3>-&gt;observe</h3><div class="usage"><code>(-&gt;observe id dist value cont state)</code></div><div class="doc"><pre class="plaintext">Positional factory function for class anglican.trap.observe.
</pre></div></div><div class="public anchor" id="var--.3Eresult"><h3>-&gt;result</h3><div class="usage"><code>(-&gt;result state)</code></div><div class="doc"><pre class="plaintext">Positional factory function for class anglican.trap.result.
</pre></div></div><div class="public anchor" id="var--.3Esample"><h3>-&gt;sample</h3><div class="usage"><code>(-&gt;sample id dist cont state)</code></div><div class="doc"><pre class="plaintext">Positional factory function for class anglican.trap.sample.
</pre></div></div><div class="public anchor" id="var-continue"><h3>continue</h3><div class="usage"><code>(continue cont value state)</code></div><div class="doc"><pre class="plaintext">returns a trampolined call to continuation
</pre></div></div><div class="public anchor" id="var-cps-of-and"><h3>cps-of-and</h3><div class="usage"><code>(cps-of-and args cont)</code></div><div class="doc"><pre class="plaintext">transforms and to CPS
</pre></div></div><div class="public anchor" id="var-cps-of-application"><h3>cps-of-application</h3><div class="usage"><code>(cps-of-application exprs cont)</code></div><div class="doc"><pre class="plaintext">transforms application to CPS;
applications of procedures are trampolined
--- wrapped into a parameterless closure</pre></div></div><div class="public anchor" id="var-cps-of-apply"><h3>cps-of-apply</h3><div class="usage"><code>(cps-of-apply args cont)</code></div><div class="doc"><pre class="plaintext">transforms apply to CPS;
сalls of procedures are trampolined
--- wrapped into a parameterless closure</pre></div></div><div class="public anchor" id="var-cps-of-case"><h3>cps-of-case</h3><div class="usage"><code>(cps-of-case args cont)</code></div><div class="doc"><pre class="plaintext">transforms case to CPS
</pre></div></div><div class="public anchor" id="var-cps-of-cond"><h3>cps-of-cond</h3><div class="usage"><code>(cps-of-cond clauses cont)</code></div><div class="doc"><pre class="plaintext">transforms cond to CPS
</pre></div></div><div class="public anchor" id="var-cps-of-do"><h3>cps-of-do</h3><div class="usage"><code>(cps-of-do exprs cont)</code></div><div class="doc"><pre class="plaintext">transforms do to CPS
</pre></div></div><div class="public anchor" id="var-cps-of-expression"><h3>cps-of-expression</h3><div class="usage"><code>(cps-of-expression expr cont)</code></div><div class="doc"><pre class="plaintext">dispatches CPS transformation by expression type
</pre></div></div><div class="public anchor" id="var-cps-of-hash-map"><h3>cps-of-hash-map</h3><div class="usage"><code>(cps-of-hash-map expr cont)</code></div><div class="doc"><pre class="plaintext">transforms literal map to CPS
</pre></div></div><div class="public anchor" id="var-cps-of-if"><h3>cps-of-if</h3><div class="usage"><code>(cps-of-if args cont)</code></div><div class="doc"><pre class="plaintext">transforms if to CPS
</pre></div></div><div class="public anchor" id="var-cps-of-let"><h3>cps-of-let</h3><div class="usage"><code>(cps-of-let [bindings &amp; body] cont)</code></div><div class="doc"><pre class="plaintext">transforms let to CPS;
body of let is trampolined
--- wrapped in a parameterless closure</pre></div></div><div class="public anchor" id="var-cps-of-loop"><h3>cps-of-loop</h3><div class="usage"><code>(cps-of-loop [bindings &amp; body] cont)</code></div><div class="doc"><pre class="plaintext">transforms loop
</pre></div></div><div class="public anchor" id="var-cps-of-observe"><h3>cps-of-observe</h3><div class="usage"><code>(cps-of-observe args cont)</code></div><div class="doc"><pre class="plaintext">transforms observe to CPS,
observe updates the weight by adding
the result of observe (log-probability)
to the log-weight</pre></div></div><div class="public anchor" id="var-cps-of-opaque"><h3>cps-of-opaque</h3><div class="usage"><code>(cps-of-opaque expr cont)</code></div><div class="doc"><pre class="plaintext">transforms opaque expression to CPS
</pre></div></div><div class="public anchor" id="var-cps-of-or"><h3>cps-of-or</h3><div class="usage"><code>(cps-of-or args cont)</code></div><div class="doc"><pre class="plaintext">transforms or to CPS
</pre></div></div><div class="public anchor" id="var-cps-of-predict"><h3>cps-of-predict</h3><div class="usage"><code>(cps-of-predict args cont)</code></div><div class="doc"><pre class="plaintext">transforms predict to CPS,
predict appends predicted expression
and its value to (:predicts $state)</pre></div></div><div class="public anchor" id="var-cps-of-recur"><h3>cps-of-recur</h3><div class="usage"><code>(cps-of-recur args cont)</code></div><div class="doc"><pre class="plaintext">transforms recur
</pre></div></div><div class="public anchor" id="var-cps-of-retrieve"><h3>cps-of-retrieve</h3><div class="usage"><code>(cps-of-retrieve args cont)</code></div><div class="doc"><pre class="plaintext">transforms retrieve to CPS
</pre></div></div><div class="public anchor" id="var-cps-of-sample"><h3>cps-of-sample</h3><div class="usage"><code>(cps-of-sample args cont)</code></div><div class="doc"><pre class="plaintext">transforms sample to CPS;
on sample the program is interrupted
and the control is transferred to the inference algorithm</pre></div></div><div class="public anchor" id="var-cps-of-set"><h3>cps-of-set</h3><div class="usage"><code>(cps-of-set expr cont)</code></div><div class="doc"><pre class="plaintext">transforms literal set to CPS
</pre></div></div><div class="public anchor" id="var-cps-of-store"><h3>cps-of-store</h3><div class="usage"><code>(cps-of-store args cont)</code></div><div class="doc"><pre class="plaintext">transforms store to CPS;
the continuation receives the stored value</pre></div></div><div class="public anchor" id="var-cps-of-vector"><h3>cps-of-vector</h3><div class="usage"><code>(cps-of-vector expr cont)</code></div><div class="doc"><pre class="plaintext">transforms literal vector to CPS
</pre></div></div><div class="public anchor" id="var-cps-of-when"><h3>cps-of-when</h3><div class="usage"><code>(cps-of-when args cont)</code></div><div class="doc"><pre class="plaintext">transforms when to CPS
</pre></div></div><div class="public anchor" id="var-defn-with-named-cont"><h3>defn-with-named-cont</h3><h4 class="type">macro</h4><div class="usage"><code>(defn-with-named-cont cps-of &amp; args)</code></div><div class="doc"><pre class="plaintext">binds the continuation to a name to make the code
slightly easier to reason about</pre></div></div><div class="public anchor" id="var-fn-cps"><h3>fn-cps</h3><div class="usage"><code>(fn-cps args)</code></div><div class="doc"><pre class="plaintext">transforms function definition to CPS form
</pre></div></div><div class="public anchor" id="var-fn-form.3F"><h3>fn-form?</h3><div class="usage"><code>(fn-form? expr)</code></div><div class="doc"><pre class="plaintext">true when the argument is a fn form
</pre></div></div><div class="public anchor" id="var-make-of-args"><h3>make-of-args</h3><div class="usage"><code>(make-of-args args make)</code><code>(make-of-args args first-is-rator make)</code></div><div class="doc"><pre class="plaintext">builds lexical bindings for all compound args
and then calls `make&apos; to build expression
out of the args; used by predict, observe, sample, application</pre></div></div><div class="public anchor" id="var-map-.3Eobserve"><h3>map-&gt;observe</h3><div class="usage"><code>(map-&gt;observe m__5869__auto__)</code></div><div class="doc"><pre class="plaintext">Factory function for class anglican.trap.observe, taking a map of keywords to field values.
</pre></div></div><div class="public anchor" id="var-map-.3Eresult"><h3>map-&gt;result</h3><div class="usage"><code>(map-&gt;result m__5869__auto__)</code></div><div class="doc"><pre class="plaintext">Factory function for class anglican.trap.result, taking a map of keywords to field values.
</pre></div></div><div class="public anchor" id="var-map-.3Esample"><h3>map-&gt;sample</h3><div class="usage"><code>(map-&gt;sample m__5869__auto__)</code></div><div class="doc"><pre class="plaintext">Factory function for class anglican.trap.sample, taking a map of keywords to field values.
</pre></div></div><div class="public anchor" id="var-mem-cps"><h3>mem-cps</h3><div class="usage"><code>(mem-cps [arg &amp; _ :as args])</code></div><div class="doc"><pre class="plaintext">transforms mem to CPS
</pre></div></div><div class="public anchor" id="var-mem-form.3F"><h3>mem-form?</h3><div class="usage"><code>(mem-form? expr)</code></div><div class="doc"><pre class="plaintext">true when the argument is a mem form
</pre></div></div><div class="public anchor" id="var-opaque-cps"><h3>opaque-cps</h3><div class="usage"><code>(opaque-cps expr)</code></div><div class="doc"><pre class="plaintext">return CPS form of an opaque expression
</pre></div></div><div class="public anchor" id="var-opaque.3F"><h3>opaque?</h3><div class="usage"><code>(opaque? expr)</code></div><div class="doc"><pre class="plaintext">true when the argument is an expression
which is passed to continuation (rather
than accepts continuation) in its CPS form</pre></div></div><div class="public anchor" id="var-primitive-operator.3F"><h3>primitive-operator?</h3><div class="usage"><code>(primitive-operator? procedure)</code></div><div class="doc"><pre class="plaintext">true if the experssion is converted by clojure 
to a primitive procedure in operator position</pre></div></div><div class="public anchor" id="var-primitive-procedure-cps"><h3>primitive-procedure-cps</h3><div class="usage"><code>(primitive-procedure-cps expr)</code></div><div class="doc"><pre class="plaintext">wraps primitive procedure as a CPS form
</pre></div></div><div class="public anchor" id="var-primitive-procedure.3F"><h3>primitive-procedure?</h3><div class="usage"><code>(primitive-procedure? procedure)</code></div><div class="doc"><pre class="plaintext">true if the procedure is primitive,
that is, does not have a CPS form</pre></div></div><div class="public anchor" id="var-result-cont"><h3>result-cont</h3><div class="usage"><code>(result-cont v s)</code></div><div class="doc"><pre class="plaintext"></pre></div></div><div class="public anchor" id="var-shading-primitive-procedures"><h3>shading-primitive-procedures</h3><h4 class="type">macro</h4><div class="usage"><code>(shading-primitive-procedures names &amp; body)</code></div><div class="doc"><pre class="plaintext">excludes names from the set of primitive procedures
</pre></div></div><div class="public anchor" id="var-simple.3F"><h3>simple?</h3><div class="usage"><code>(simple? expr)</code></div><div class="doc"><pre class="plaintext">true if expr has no continuation
</pre></div></div><div class="public anchor" id="var-state-cont"><h3>state-cont</h3><div class="usage"><code>(state-cont _ s)</code></div><div class="doc"><pre class="plaintext">returns state
</pre></div></div><div class="public anchor" id="var-value-cont"><h3>value-cont</h3><div class="usage"><code>(value-cont v _)</code></div><div class="doc"><pre class="plaintext">returns value
</pre></div></div></div></body></html>